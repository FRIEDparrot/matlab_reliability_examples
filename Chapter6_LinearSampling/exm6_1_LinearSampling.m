clear, clc;
%% %%%%%%%%%%%% 6.1 %%%%%%%%%%%%%%%%%%%%%%%%
mu_ = [0, 0, 0];
sigma_d = [1, 1, 1];
sigma_ = diag(sigma_d.^2);
g = @(x) -15 .* x(:,1) + x(:,2).^2 - 3.* x(:,2) +  x(:,3).^2 + 5 .* x(:,3) + 40;
Pf1 = LS_solu(mu_, sigma_, g, 3e4)

clear mu_ sigma_d sigma_ g
% Pf1: 0.004235600000000 

%% %%%%%%%%%%%% 6.2 (求解速度慢）%%%%%%%%%%%%%
mu_ = ones(1, 3000);
sigma_d = 0.2 * ones(1, 3000); 
sigma_ = diag(sigma_d.^2);
g = @(x) 3000 + 3.0.* 0.2 * sqrt(3000) - sum(x, 2);
Pf2 = LS_solu(mu_, sigma_, g,1e3)
clear mu_ sigma_d sigma_ g
% Pf2: 0.001349896394643

%% %%%%%%%%%%%% 6.3 %%%%%%%%%%%%%%%%%%%%%%%%
mu_ = [20, 460, 19, 392];
sigma_d = [2.4, 7, 0.8, 31.4];
sigma_ = diag(sigma_d.^2);
g = @(x) x(:,4) -  x(:,1) .* x(:,2) ./(2 * x(:,3));
Pf3 = LS_solu(mu_, sigma_, g, 4e3)
% Pf3: 4.553800542290768e-04

clear mu_ sigma_d sigma_ g
% s, p, d, t : 320.634706, 25.238194, 462.437569, 18.199978

%% %%%%%%%%%%% 6.6 %%%%%%%%%%%%%%%%%%%%%%%
mu_  = [2, 3, 10];
rho_ = [ 1, 0.5 ,  0.6; 0.5, 1, 0.2; 0.6, 0.2, 1]; 
sigma_  = rho_ .* ([1, 1.5 , 2]' * [1, 1.5, 2]);      %% *** 协方差矩阵 *****
g = @(x) x(:,1) +2.* x(:,2) - x(:,3) + 5;

Pf4 = LS_solu(mu_, sigma_, g, 4e3)
% Pf4: 0.195198533995105